LOAD EMPLOYEE

C <- CROSS EMPLOYEE EMPLOYEE

H <- SELECT EMPLOYEE1_Ssn == EMPLOYEE2_Super_ssn FROM C

G <- SELECT EMPLOYEE1_Dno != EMPLOYEE2_Dno FROM H

Q1 <- PROJECT EMPLOYEE1_Dno, EMPLOYEE2_Ssn, EMPLOYEE2_Super_ssn, EMPLOYEE2_Dno FROM G

RENAME EMPLOYEE2_Ssn TO Ssn FROM Q1

RENAME EMPLOYEE2_Dno TO Dno FROM Q1

RENAME EMPLOYEE2_Super_ssn TO Super_ssn FROM Q1

RENAME EMPLOYEE1_Dno TO Super_dno FROM Q1



LOAD A

LOAD B

LOAD C

D <- CROSS A B

E <- SELECT Ssn == Essn FROM A

F <- CROSS E C

G <- SELECT Dno == Dnum FROM F

H <- SELECT Pno == Pnumber FROM G

RENAME Dnum TO P_dno FROM H

Q2 <- PROJECT Ssn,Dno,Pno,P_dno FROM H

LOAD EMPLOYEE

LOAD WORKS_ON

LOAD PROJECT

A <- CROSS EMPLOYEE WORKS_ON

B <- SELECT Ssn == Essn FROM A

C <- CROSS B PROJECT

D <- SELECT Pno == Pnumber FROM C

Q3 <- SELECT Dno != Dnum FROM D

RENAME Dnum TO P_dno FROM Q3



LOAD EMPLOYEE
A <- PROJECT Ssn,Bdate,Super_ssn FROM EMPLOYEE
B <- CROSS A A
C <- SELECT A1_Super_ssn == A2_Ssn FROM B
D <- SELECT A1_Bdate < A2_Bdate FROM C

RENAME A1_Ssn TO Essn FROM D

RENAME A2_Ssn TO Super_Ssn FROM D

RENAME A1_Bdate TO E_bdate FROM D

RENAME A2_Bdate TO Super_bdate FROM D

Q4 <- PROJECT Super_Ssn,Super_bdate,Essn,E_bdate FROM P




LOAD EMPLOYEE

S <- CROSS EMPLOYEE EMPLOYEE

T <- SELECT EMPLOYEE1_Sex != EMPLOYEE2_Sex FROM S

U <- SELECT EMPLOYEE1_Dno == EMPLOYEE2_Dno FROM T

RENAME EMPLOYEE1_Dno TO Dno FROM U

Q5 <- PROJECT Dno FROM U

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5
QUIT